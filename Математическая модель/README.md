# Математическая модель пересчета пути
Пересчет пути происходит при помощи колесной одометрии

![](https://github.com/WWnotLL/ROS2_tutorial_305/blob/main/изображения%20к%20тексту/Колесо%20%2B%20энкодер.png)

## Обработка данных с энкодера

Получить пройденное каждым колесом растояние можно по формуле:
## $s = \frac{n}{n_{об}} \cdot 2 \pi R$,

где <i>n</i> - количество отсчётов энкодера за время измерения;

$n_{об}$ - количество отсчётов энкодера за 1 оборот колеса;

$R$ - радиус колеса

В свою очередь, поступательная скорость колеса определяется выражением:


## $v = \frac{\Delta s}{\Delta t} = \frac{n}{n_{об}} \cdot \frac{2 \pi R}{\Delta t}$,

где $\Delta s$ - путь пройденный за временной интервал $\Delta t$

## Расчёт линейной скорости робота

![](https://github.com/WWnotLL/ROS2_tutorial_305/blob/main/изображения%20к%20тексту/пересчет%20вид%20сверху.png)

Средняя поступательная скорость по продольной оси $v_{xc}$ определяется следующим образом:

## $v_{xc} = \frac{v_{пл} + v_{ппр} + v_{зл} + v_{зпр}}{4}$

Боковые перемещения для данной конструкции отсутствуют, следовательно скорость по поперечной оси $v_{yc}$ :

### $v_{yc} = 0$

## Расчёт угловой скорости

Поворот робота происходит в том случае, когда скорости левых и правых колёс различны. Угловая скорость определяется следующим образом:

## $\omega_{zc} = \frac{v_{пр}^{ср} - v_{л}^{ср}}{b/2} = \frac{\frac{v_{ппр} + v_{зпр}}{2} - \frac{v_{пл} + v_{зл}}{2}}{b/2}$

## $\omega_{zc} = \frac{(v_{ппр} + v_{зпр}) - (v_{пл} + v_{зл})}{b}$


## Определение положения и ориентации робота

Для определения ориентации в локальной системе координат необходимо проинтегрировать угловую скорость робота $\omega_{zc}$

## $\psi = \int \omega_{zc} dt$

Для определения координат по осям необходимо спроецировать скорость на оси локальной системы координат $x и y$ и проинтегрировать по времени

## $x = \int v \cdot \cos(\psi) dt$

## $y = \int v \cdot \sin(\psi) dt$
